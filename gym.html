<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mobile 864 Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif}
body{background:linear-gradient(180deg,#020617,#020617,#0f172a);color:#e5e7eb}
.app{max-width:520px;margin:0 auto;min-height:100vh;display:flex;flex-direction:column}
.header{padding:12px 14px 8px;border-bottom:1px solid rgba(148,163,184,.3);display:flex;justify-content:space-between;align-items:center}
.h-left{display:flex;flex-direction:column;gap:2px}
.h-title{font-size:16px;font-weight:600}
.h-sub{font-size:11px;color:#9ca3af}
.h-right{display:flex;flex-direction:column;align-items:flex-end;gap:2px}
.h-date{font-size:12px;color:#9ca3af}
.h-time{font-size:13px;font-weight:500}
.unit-select{margin-top:4px;border-radius:999px;border:1px solid rgba(148,163,184,.6);background:rgba(15,23,42,.95);color:#e5e7eb;font-size:11px;padding:3px 8px}
.tabs{display:flex;overflow-x:auto;border-bottom:1px solid rgba(148,163,184,.3);background:#020617}
.tab{flex:1;min-width:20%;text-align:center;padding:10px 4px;font-size:12px;background:transparent;color:#9ca3af;border-right:1px solid rgba(31,41,55,.8)}
.tab:last-child{border-right:none}
.tab span{display:block;font-size:10px;color:#6b7280}
.tab.active{background:linear-gradient(135deg,#2563eb,#f97316);color:#f9fafb}
.tab.active span{color:#e5e7eb}
.screen{flex:1;display:flex;flex-direction:column}
.section-switch{display:flex;border-bottom:1px solid rgba(31,41,55,.9);background:#020617}
.section-btn{flex:1;text-align:center;padding:8px 4px;font-size:11px;border:none;background:transparent;color:#9ca3af}
.section-btn.active{color:#f9fafb;border-bottom:2px solid #f97316}
.content{flex:1;overflow-y:auto;padding:10px 10px 12px}
.card{border-radius:12px;background:rgba(15,23,42,.96);border:1px solid rgba(31,41,55,.95);padding:10px;margin-bottom:10px}
.card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}
.card-title{font-size:13px;font-weight:600}
.card-sub{font-size:11px;color:#9ca3af}
.badge{font-size:10px;border-radius:999px;padding:3px 7px;border:1px solid rgba(148,163,184,.7);background:rgba(15,23,42,.96)}
.badge-main{border-color:rgba(74,222,128,.9);color:#bbf7d0}
.badge-sec{border-color:rgba(96,165,250,.9);color:#bfdbfe}
.stat-line{font-size:11px;color:#e5e7eb;margin-top:2px}
.stat-line span{color:#9ca3af}
.notes-area{width:100%;border-radius:10px;border:1px solid rgba(55,65,81,.9);background:rgba(15,23,42,.96);color:#e5e7eb;font-size:12px;padding:8px;resize:vertical;min-height:70px}
.btn-row{display:flex;gap:8px;margin-top:6px}
.btn{flex:1;border-radius:999px;border:none;font-size:12px;font-weight:500;padding:7px 8px}
.btn-primary{background:linear-gradient(135deg,#2563eb,#f97316);color:#f9fafb}
.btn-ghost{background:transparent;color:#e5e7eb;border:1px solid rgba(148,163,184,.7)}
.exercise{border-radius:12px;background:radial-gradient(circle at top left,rgba(37,99,235,.22),rgba(15,23,42,.98));border:1px solid rgba(31,41,55,.98);padding:9px;margin-bottom:9px}
.exercise-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
.exercise-name{font-size:13px;font-weight:600}
.exercise-meta{font-size:10px;color:#9ca3af}
.sets{display:grid;grid-template-columns:repeat(3,1fr);gap:6px}
.set-card{border-radius:10px;background:rgba(15,23,42,.98);border:1px solid rgba(31,41,55,.98);padding:5px}
.set-label{font-size:10px;color:#9ca3af;margin-bottom:3px}
.set-input{width:100%;padding:6px;border-radius:999px;border:none;background:rgba(2,6,23,.96);color:#e5e7eb;font-size:12px;text-align:center}
.exercise-footer{display:flex;flex-direction:column;gap:4px;margin-top:6px}
.exercise-stats{display:flex;justify-content:space-between;align-items:center;font-size:10px}
.tag{font-size:10px;border-radius:999px;padding:2px 6px;border:1px solid rgba(148,163,184,.7);background:rgba(15,23,42,.98)}
.tag-up{border-color:#4ade80;color:#bbf7d0}
.tag-down{border-color:#fb7185;color:#fecaca}
.tag-flat{border-color:#facc15;color:#fef9c3}
.exercise-suggestion{font-size:11px;color:#a5f3fc;min-height:13px}
.exercise-btn{margin-top:4px;width:100%;border-radius:999px;border:none;background:linear-gradient(135deg,#22c55e,#4ade80);color:#052e16;font-size:12px;font-weight:600;padding:7px}
.progress-item{font-size:11px;margin-top:3px}
.progress-item span{color:#9ca3af}
.status-up{color:#4ade80}
.status-down{color:#fb7185}
.status-flat{color:#facc15}
.footer{padding:8px 10px 10px;font-size:10px;text-align:center;color:#6b7280;border-top:1px solid rgba(31,41,55,.9)}
</style>
</head>
<body>
<div class="app">
  <div class="header">
    <div class="h-left">
      <div class="h-title">864 Workout Log</div>
      <div class="h-sub">Mon–Fri · Local progression tracking</div>
    </div>
    <div class="h-right">
      <div class="h-date" id="hDate"></div>
      <div class="h-time" id="hTime"></div>
      <select id="unitSelect" class="unit-select">
        <option value="lb">lb</option>
        <option value="kg">kg</option>
      </select>
    </div>
  </div>

  <div class="tabs" id="tabs"></div>

  <div class="screen">
    <div class="section-switch">
      <button class="section-btn active" data-section="ex">Exercises</button>
      <button class="section-btn" data-section="pr">Progress</button>
      <button class="section-btn" data-section="nt">Notes</button>
    </div>
    <div class="content">
      <div id="section-ex"></div>
      <div id="section-pr" style="display:none"></div>
      <div id="section-nt" style="display:none"></div>
    </div>
  </div>

  <div class="footer">Data stays on this device · Hit save per exercise and per notes</div>
</div>

<script>
const days=["Monday","Tuesday","Wednesday","Thursday","Friday"]
const plan={
  Monday:{
    label:"Chest + Triceps",
    ex:[
      {id:"bench",name:"Bench Press",main:true},
      {id:"incline_db",name:"Incline DB Press",main:true},
      {id:"fly",name:"Machine / Cable Fly",main:false},
      {id:"dips",name:"Dips / Chest Press",main:false},
      {id:"tri_push",name:"Triceps Pushdown",main:false},
      {id:"tri_oh",name:"Overhead Triceps",main:false}
    ]
  },
  Tuesday:{
    label:"Back + Biceps",
    ex:[
      {id:"lat",name:"Lat Pulldown / Pull-Ups",main:true},
      {id:"row_bar",name:"Barbell / Machine Row",main:true},
      {id:"row_seat",name:"Seated Cable Row",main:false},
      {id:"face",name:"Face Pulls",main:false},
      {id:"curl_bar",name:"Barbell Curl",main:false},
      {id:"curl_ham",name:"Hammer Curl",main:false}
    ]
  },
  Wednesday:{
    label:"Legs (Machines)",
    ex:[
      {id:"leg_press",name:"Leg Press",main:true},
      {id:"hack",name:"Hack Squat",main:true},
      {id:"leg_curl",name:"Leg Curl",main:false},
      {id:"leg_ext",name:"Leg Extension",main:false},
      {id:"calf",name:"Standing Calf Raises",main:false}
    ]
  },
  Thursday:{
    label:"Shoulders + Core",
    ex:[
      {id:"oh",name:"Overhead Press",main:true},
      {id:"lat_raise",name:"Lateral Raise",main:false},
      {id:"rear",name:"Rear Delt Fly",main:false},
      {id:"shrug",name:"Shrugs",main:false},
      {id:"hleg",name:"Hanging Leg Raise",main:false},
      {id:"crunch",name:"Cable Crunch / Plank",main:false}
    ]
  },
  Friday:{
    label:"Upper Strength",
    ex:[
      {id:"bench",name:"Bench Press (Strength)",main:true},
      {id:"dead",name:"Deadlift",main:true},
      {id:"pull_str",name:"Pull-Ups / Heavy Pull",main:false},
      {id:"incline_db",name:"Incline DB Press",main:false},
      {id:"curl_ez",name:"EZ Bar Curl",main:false},
      {id:"skull",name:"Skull Crushers",main:false}
    ]
  }
}
const storeKey="m864_tracker_v1"

function loadStore(){
  try{
    const raw=localStorage.getItem(storeKey)
    if(!raw)return{w:[],unit:"lb"}
    const p=JSON.parse(raw)
    if(!p.w)p.w=[]
    if(!p.unit)p.unit="lb"
    return p
  }catch(e){
    return{w:[],unit:"lb"}
  }
}
function saveStore(s){
  localStorage.setItem(storeKey,JSON.stringify(s))
}
function todayKey(){
  return new Date().toISOString().slice(0,10)
}
function calc1RM(w,r){
  if(!w||!r)return null
  return Math.round(w*(1+r/30))
}
function prevBest(store,exId,beforeDate){
  const arr=[]
  store.w.forEach(d=>{
    if(d.date<beforeDate){
      d.e.forEach(en=>{
        if(en.id===exId&&en.s&&en.s.best1){
          arr.push(en.s.best1)
        }
      })
    }
  })
  if(!arr.length)return null
  return Math.max(...arr)
}
function exHistory(store,exId){
  const h=[]
  store.w.forEach(d=>{
    d.e.forEach(en=>{
      if(en.id===exId&&en.s&&en.s.best1){
        h.push({date:d.date,v:en.s.best1})
      }
    })
  })
  h.sort((a,b)=>a.date.localeCompare(b.date))
  return h
}
function bumpText(store,exId,todayBest,dateKey){
  if(!todayBest)return""
  const h=exHistory(store,exId).filter(x=>x.date<=dateKey)
  if(h.length<3)return""
  const last=h.slice(-3)
  const vals=last.map(x=>x.v)
  const min=Math.min(...vals)
  const max=Math.max(...vals)
  if(max-min<todayBest*0.02)return""
  const lastVal=last[last.length-1].v
  if(Math.abs(lastVal-todayBest)/todayBest<0.015){
    return"Solid across last sessions. If sets feel clean, try a small weight bump next time."
  }
  return""
}
function statusTag(diffPct){
  if(diffPct>2.5)return"up"
  if(diffPct<-2.5)return"down"
  return"flat"
}
function updateClock(){
  const t=new Date()
  document.getElementById("hDate").textContent=t.toLocaleDateString(undefined,{weekday:"long",month:"short",day:"numeric"})
  document.getElementById("hTime").textContent=t.toLocaleTimeString(undefined,{hour:"2-digit",minute:"2-digit",second:"2-digit"})
}
setInterval(updateClock,1000)
updateClock()

const tabsEl=document.getElementById("tabs")
const secEx=document.getElementById("section-ex")
const secPr=document.getElementById("section-pr")
const secNt=document.getElementById("section-nt")
const unitSel=document.getElementById("unitSelect")
let activeDay=(()=>{
  const idx=new Date().getDay()-1
  if(idx>=0&&idx<=4)return days[idx]
  return"Monday"
})()
function initTabs(){
  tabsEl.innerHTML=""
  days.forEach(d=>{
    const el=document.createElement("div")
    el.className="tab"+(d===activeDay?" active":"")
    const l1=document.createElement("div")
    l1.textContent=d.slice(0,3)
    const l2=document.createElement("span")
    l2.textContent=plan[d].label.split(" ")[0]
    el.appendChild(l1)
    el.appendChild(l2)
    el.onclick=()=>{
      activeDay=d
      document.querySelectorAll(".tab").forEach(x=>x.classList.remove("active"))
      el.classList.add("active")
      renderAll()
    }
    tabsEl.appendChild(el)
  })
}
function initSections(){
  const btns=document.querySelectorAll(".section-btn")
  btns.forEach(b=>{
    b.onclick=()=>{
      btns.forEach(x=>x.classList.remove("active"))
      b.classList.add("active")
      const k=b.dataset.section
      secEx.style.display=k==="ex"?"block":"none"
      secPr.style.display=k==="pr"?"block":"none"
      secNt.style.display=k==="nt"?"block":"none"
    }
  })
}
function initUnits(){
  const s=loadStore()
  unitSel.value=s.unit
  unitSel.onchange=()=>{
    const st=loadStore()
    st.unit=unitSel.value
    saveStore(st)
    renderAll()
  }
}
function renderExercises(){
  const st=loadStore()
  const tKey=todayKey()
  let dayEntry=st.w.find(x=>x.date===tKey&&x.day===activeDay)
  secEx.innerHTML=""
  const wrap=document.createElement("div")
  const head=document.createElement("div")
  head.className="card"
  const hh=document.createElement("div")
  hh.className="card-header"
  const ht=document.createElement("div")
  ht.className="card-title"
  ht.textContent=activeDay+" · "+plan[activeDay].label
  const hs=document.createElement("div")
  hs.className="card-sub"
  const exCount=dayEntry?dayEntry.e.filter(e=>e.s&&e.s.best1).length:0
  const setCount=dayEntry?dayEntry.e.reduce((a,e)=>a+(e.sets?e.sets.filter(s=>s.w&&s.r).length:0),0):0
  hs.textContent=exCount?"Logged "+exCount+" exercises · "+setCount+" sets today":"No sets logged today yet."
  hh.appendChild(ht)
  hh.appendChild(hs)
  head.appendChild(hh)
  wrap.appendChild(head)
  plan[activeDay].ex.forEach(cfg=>{
    const exCard=document.createElement("div")
    exCard.className="exercise"
    exCard.dataset.eid=cfg.id
    const exH=document.createElement("div")
    exH.className="exercise-header"
    const exName=document.createElement("div")
    exName.className="exercise-name"
    exName.textContent=cfg.name
    const exMeta=document.createElement("div")
    exMeta.className="exercise-meta"
    exMeta.textContent=cfg.main?"Main lift · 8/6/4":"Accessory · 8/6/4"
    exH.appendChild(exName)
    exH.appendChild(exMeta)
    const badge=document.createElement("div")
    badge.className="badge "+(cfg.main?"badge-main":"badge-sec")
    badge.textContent=cfg.main?"Priority":"Support"
    exH.appendChild(badge)
    exCard.appendChild(exH)
    const setsDiv=document.createElement("div")
    setsDiv.className="sets"
    const targets=[8,6,4]
    let savedEntry=dayEntry?dayEntry.e.find(e=>e.id===cfg.id):null
    const savedSets=savedEntry&&savedEntry.sets?savedEntry.sets:[{},{},{}]
    for(let i=0;i<3;i++){
      const sc=document.createElement("div")
      sc.className="set-card"
      const sl=document.createElement("div")
      sl.className="set-label"
      sl.textContent="Set "+(i+1)+" · target "+targets[i]
      const inp=document.createElement("input")
      inp.type="number"
      inp.min="0"
      inp.className="set-input"
      inp.placeholder="Weight"
      inp.value=savedSets[i]&&savedSets[i].w?savedSets[i].w:""
      inp.dataset.idx=i
      sc.appendChild(sl)
      sc.appendChild(inp)
      setsDiv.appendChild(sc)
    }
    exCard.appendChild(setsDiv)
    const f=document.createElement("div")
    f.className="exercise-footer"
    const statRow=document.createElement("div")
    statRow.className="exercise-stats"
    const oneRm=document.createElement("div")
    oneRm.id="one_"+cfg.id
    oneRm.textContent="1RM: N/A"
    const tag=document.createElement("div")
    tag.id="tag_"+cfg.id
    tag.className="tag tag-flat"
    tag.textContent="No trend yet"
    statRow.appendChild(oneRm)
    statRow.appendChild(tag)
    const sug=document.createElement("div")
    sug.id="sug_"+cfg.id
    sug.className="exercise-suggestion"
    sug.textContent="Log at least one set to get feedback."
    const btn=document.createElement("button")
    btn.className="exercise-btn"
    btn.textContent="Save "+cfg.name
    btn.onclick=()=>saveExercise(cfg.id)
    f.appendChild(statRow)
    f.appendChild(sug)
    f.appendChild(btn)
    exCard.appendChild(f)
    if(savedEntry&&savedEntry.s&&savedEntry.s.best1){
      oneRm.textContent="1RM: "+savedEntry.s.best1.toFixed(0)+" "+st.unit
      const prev=prevBest(st,cfg.id,tKey)
      if(prev){
        const diff=savedEntry.s.best1-prev
        const pct=prev?diff/prev*100:0
        const stType=statusTag(pct)
        tag.className="tag "+(stType==="up"?"tag-up":stType==="down"?"tag-down":"tag-flat")
        if(stType==="up")tag.textContent="Up "+pct.toFixed(1)+"% vs last best"
        else if(stType==="down")tag.textContent="Down "+pct.toFixed(1)+"% vs last best"
        else tag.textContent="About same as last best"
      }else{
        tag.className="tag tag-flat"
        tag.textContent="Baseline logged"
      }
      if(savedEntry.s.msg)sug.textContent=savedEntry.s.msg
    }
    wrap.appendChild(exCard)
  })
  secEx.appendChild(wrap)
}
function saveExercise(exId){
  const st=loadStore()
  const tKey=todayKey()
  let d=st.w.find(x=>x.date===tKey&&x.day===activeDay)
  if(!d){
    d={date:tKey,day:activeDay,e:[],note:""}
    st.w.push(d)
  }
  let e=d.e.find(x=>x.id===exId)
  if(!e){
    e={id:exId,sets:[],s:null}
    d.e.push(e)
  }
  const card=document.querySelector('.exercise[data-eid="'+exId+'"]')
  if(!card)return
  const inputs=card.querySelectorAll(".set-input")
  const targets=[8,6,4]
  const sets=[]
  inputs.forEach((inp,i)=>{
    const v=inp.value?parseFloat(inp.value):null
    if(v&&v>0)sets.push({w:v,r:targets[i]})
    else sets.push({w:null,r:targets[i]})
  })
  const valid=sets.filter(s=>s.w&&s.r)
  if(!valid.length){
    alert("Enter at least one set with weight.")
    return
  }
  let best1=null
  let bestSet=null
  valid.forEach(s=>{
    const est=calc1RM(s.w,s.r)
    if(est&&(best1===null||est>best1)){
      best1=est
      bestSet=s
    }
  })
  const prev=prevBest(st,exId,tKey)
  let msg=""
  let stat="flat"
  if(best1&&prev){
    const diff=best1-prev
    const pct=prev?diff/prev*100:0
    const stTag=statusTag(pct)
    stat=stTag
    if(stTag==="up")msg="Nice jump, about "+pct.toFixed(1)+"% over your last best. If it felt clean, you can try a small bump next time."
    else if(stTag==="down")msg="Below your recent best. Check sleep, food, and form before pushing the weight."
    else msg="Very similar to your last best. Hold or micro-increase next time depending on how it felt."
  }else if(best1&&!prev){
    msg="Baseline set saved. Next sessions will compare to this."
  }
  const bump=bumpText(st,exId,best1,tKey)
  if(bump)msg=bump
  e.sets=sets
  e.s={best1:best1||null,bestSet:bestSet||null,stat,msg}
  saveStore(st)
  renderExercises()
  renderProgress()
}
function renderProgress(){
  const st=loadStore()
  const unit=st.unit
  secPr.innerHTML=""
  const wrap=document.createElement("div")
  const today=todayKey()
  const cardToday=document.createElement("div")
  cardToday.className="card"
  const h=document.createElement("div")
  h.className="card-header"
  const t=document.createElement("div")
  t.className="card-title"
  t.textContent="Today summary"
  const s=document.createElement("div")
  s.className="card-sub"
  const dayEntry=st.w.find(x=>x.date===today&&x.day===activeDay)
  let exC=0,setC=0
  if(dayEntry){
    exC=dayEntry.e.filter(e=>e.s&&e.s.best1).length
    setC=dayEntry.e.reduce((a,e)=>a+(e.sets?e.sets.filter(s=>s.w&&s.r).length:0),0)
  }
  s.textContent=exC?("Exercises: "+exC+" · Sets: "+setC):"Nothing logged yet for today."
  h.appendChild(t)
  h.appendChild(s)
  cardToday.appendChild(h)
  if(dayEntry&&dayEntry.e.length){
    dayEntry.e.forEach(e=>{
      if(!(e.s&&e.s.best1))return
      const line=document.createElement("div")
      line.className="stat-line"
      const sp=document.createElement("span")
      sp.textContent=e.id+" · "
      line.appendChild(sp)
      line.appendChild(document.createTextNode(e.s.best1.toFixed(0)+" "+unit+" est 1RM"))
      cardToday.appendChild(line)
    })
  }
  wrap.appendChild(cardToday)
  const keyCard=document.createElement("div")
  keyCard.className="card"
  const kh=document.createElement("div")
  kh.className="card-header"
  const kt=document.createElement("div")
  kt.className="card-title"
  kt.textContent="Key lift trends"
  const ks=document.createElement("div")
  ks.className="card-sub"
  ks.textContent="Compares first log vs latest for major lifts."
  kh.appendChild(kt);kh.appendChild(ks);keyCard.appendChild(kh)
  const keyEx=["bench","dead","leg_press","oh","lat"]
  const names={bench:"Bench Press",dead:"Deadlift",leg_press:"Leg Press",oh:"Overhead Press",lat:"Pulldown / Pull-Ups"}
  let any=false
  keyEx.forEach(id=>{
    const hst=exHistory(st,id)
    if(!hst.length)return
    any=true
    const first=hst[0].v
    const last=hst[hst.length-1].v
    const diff=last-first
    const pct=first?(diff/first*100):0
    const row=document.createElement("div")
    row.className="progress-item"
    const sp=document.createElement("span")
    sp.textContent=names[id]+": "
    const v=document.createElement("span")
    let cls="status-flat"
    if(pct>2.5)cls="status-up"
    if(pct<-2.5)cls="status-down"
    v.className=cls
    let txt=last.toFixed(0)+" "+unit
    if(pct>2.5)txt+=" ("+pct.toFixed(1)+"% up)"
    else if(pct<-2.5)txt+=" ("+pct.toFixed(1)+"% change)"
    row.appendChild(sp)
    v.textContent=txt
    row.appendChild(v)
    keyCard.appendChild(row)
  })
  if(!any){
    const row=document.createElement("div")
    row.className="stat-line"
    row.textContent="Log bench, deadlift, leg press, pulldown, or OHP to see trend lines."
    keyCard.appendChild(row)
  }
  wrap.appendChild(keyCard)
  const globalCard=document.createElement("div")
  globalCard.className="card"
  const gh=document.createElement("div")
  gh.className="card-header"
  const gt=document.createElement("div")
  gt.className="card-title"
  gt.textContent="Overall stats"
  const gs=document.createElement("div")
  gs.className="card-sub"
  const sessionCount=st.w.length
  gs.textContent="Sessions logged: "+sessionCount
  gh.appendChild(gt);gh.appendChild(gs);globalCard.appendChild(gh)
  let best=null
  st.w.forEach(d=>{
    d.e.forEach(e=>{
      if(e.s&&e.s.best1){
        if(best===null||e.s.best1>best)best=e.s.best1
      }
    })
  })
  const bestLine=document.createElement("div")
  bestLine.className="stat-line"
  bestLine.innerHTML="<span>Top 1RM recorded:</span> "+(best?best.toFixed(0)+" "+unit:"N/A")
  globalCard.appendChild(bestLine)
  wrap.appendChild(globalCard)
  secPr.appendChild(wrap)
}
function renderNotes(){
  const st=loadStore()
  const tKey=todayKey()
  let d=st.w.find(x=>x.date===tKey&&x.day===activeDay)
  secNt.innerHTML=""
  const card=document.createElement("div")
  card.className="card"
  const h=document.createElement("div")
  h.className="card-header"
  const t=document.createElement("div")
  t.className="card-title"
  t.textContent="Day notes"
  const s=document.createElement("div")
  s.className="card-sub"
  s.textContent="Write anything about sleep, energy, pain, pump."
  h.appendChild(t);h.appendChild(s);card.appendChild(h)
  const ta=document.createElement("textarea")
  ta.className="notes-area"
  ta.id="notesBox"
  ta.value=d&&d.note?d.note:""
  const row=document.createElement("div")
  row.className="btn-row"
  const save=document.createElement("button")
  save.className="btn btn-primary"
  save.textContent="Save notes"
  save.onclick=()=>{
    const st2=loadStore()
    const tKey2=todayKey()
    let day=st2.w.find(x=>x.date===tKey2&&x.day===activeDay)
    if(!day){
      day={date:tKey2,day:activeDay,e:[],note:""}
      st2.w.push(day)
    }
    day.note=document.getElementById("notesBox").value.trim()
    saveStore(st2)
    renderNotes()
  }
  const clear=document.createElement("button")
  clear.className="btn btn-ghost"
  clear.textContent="Clear today"
  clear.onclick=()=>{
    if(!confirm("Clear this day's notes and sets for today?"))return
    const st2=loadStore()
    const tKey2=todayKey()
    st2.w=st2.w.filter(x=>!(x.date===tKey2&&x.day===activeDay))
    saveStore(st2)
    renderAll()
  }
  row.appendChild(save)
  row.appendChild(clear)
  card.appendChild(ta)
  card.appendChild(row)
  secNt.appendChild(card)
}
function renderAll(){
  renderExercises()
  renderProgress()
  renderNotes()
}
initTabs()
initSections()
initUnits()
renderAll()
</script>
</body>
</html>